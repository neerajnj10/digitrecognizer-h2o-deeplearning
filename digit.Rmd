
##digitrecognizer

Neeraj
December 27, 2015

```{r}
#install.packages("readr")
library(readr)
## Warning: package 'readr' was built under R version 3.2.3
train <- read_csv("train.csv")
test <- read_csv("test.csv")
head(train[1:10])
```

```
##   label pixel0 pixel1 pixel2 pixel3 pixel4 pixel5 pixel6 pixel7 pixel8
## 1     1      0      0      0      0      0      0      0      0      0
## 2     0      0      0      0      0      0      0      0      0      0
## 3     1      0      0      0      0      0      0      0      0      0
## 4     4      0      0      0      0      0      0      0      0      0
## 5     0      0      0      0      0      0      0      0      0      0
## 6     0      0      0      0      0      0      0      0      0      0
# Create a 28*28 matrix with pixel color values
m = matrix(unlist(train[10,-1]),nrow = 28,byrow = T)
# Plot that matrix
image(m,col=grey.colors(255))

```
![pixel]("data:image/png;base64,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")

This image needs to be rotated to the right. I will rotate the matrix and plot a bunch of images.
rotate <- function(x) t(apply(x, 2, rev)) # reverses (rotates the matrix)

```{r}

# Plot a bunch of images
par(mfrow=c(2,3))
lapply(1:6, 
    function(x) image(
                    rotate(matrix(unlist(train[x,-1]),nrow = 28,byrow = T)),
                    col=grey.colors(255),
                    xlab=train[x,1]
                )
)

```


```

## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL

```

```{r}

par(mfrow=c(1,1)) # set plot options back to default
library(h2o)
## Loading required package: statmod
## 
## ----------------------------------------------------------------------
## 
## Your next step is to start H2O and get a connection object (named
## 'localH2O', for example):
##     > localH2O = h2o.init()
## 
## For H2O package documentation, ask for help:
##     > ??h2o
## 
## After starting H2O, you can use the Web UI at http://localhost:54321
## For more information visit http://docs.h2o.ai
## 
## ----------------------------------------------------------------------
## start a local h2o cluster
localH2O = h2o.init(#max_mem_size = '6g', # use 6GB of RAM of *GB available
                    nthreads = -1) # use all CPUs (8 on my personal computer :3)
## 
## H2O is not running yet, starting it now...
## Warning in .h2o.startJar(nthreads = nthreads, max_memory = max_mem_size, : You have a 32-bit version of Java. H2O works best with 64-bit Java.
## Please download the latest Java SE JDK 7 from the following URL:
## http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html
## 
## Note:  In case of errors look at the following log files:
##     C:\Users\NJ_NEE~1\AppData\Local\Temp\RtmpkFuuvK/h2o_Nj_neeraj_started_from_r.out
##     C:\Users\NJ_NEE~1\AppData\Local\Temp\RtmpkFuuvK/h2o_Nj_neeraj_started_from_r.err
## 
## 
## .Successfully connected to http://127.0.0.1:54321/ 
## 
## R is connected to the H2O cluster: 
##     H2O cluster uptime:         2 seconds 912 milliseconds 
##     H2O cluster version:        3.2.0.3 
##     H2O cluster name:           H2O_started_from_R_Nj_neeraj_fut736 
##     H2O cluster total nodes:    1 
##     H2O cluster total memory:   0.97 GB 
##     H2O cluster total cores:    4 
##     H2O cluster allowed cores:  4 
##     H2O cluster healthy:        TRUE

```


Now, I just convert the train and test sets into the h2o format and set up the model. The h2o.deeplearning() function has lots of configurable arguments. For demonstration I went with a two layer neural network with 100 nodes and 0.5 dropout ratio in each. While I could specify a learning rate I decided not to because it is adaptive by default which should result in an improved accuracy score. This blog post explores the deeplearning using h2o and its many configurable options. I used it for reference. So let’s train the model.

```{r}

## MNIST data as H2O
train[,1] = as.factor(train[,1]) # convert digit labels to factor for classification
train_h2o = as.h2o(train)
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%
test_h2o = as.h2o(test)
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |=================================================================| 100%
## set timer
s <- proc.time()

## train model
model =
  h2o.deeplearning(x = 2:785,  # column numbers for predictors
                   y = 1,   # column number for label
                   training_frame = train_h2o, # data in H2O format
                   activation = "RectifierWithDropout", # algorithm
                   input_dropout_ratio = 0.2, # % of inputs dropout
                   hidden_dropout_ratios = c(0.5,0.5), # % for nodes dropout
                   balance_classes = TRUE, 
                   hidden = c(100,100), # two layers of 100 nodes
                   momentum_stable = 0.99,
                   nesterov_accelerated_gradient = T, # use it for speed
                   epochs = 15) # no. of epochs
## 
  |                                                                       
  |                                                                 |   0%
## Warning in .h2o.validateModelParameters(conn, algo, param_values, h2oRestApiVersion): Dropping constant columns: pixel0, pixel1, pixel2, pixel3, pixel4, pixel5, pixel6, pixel7, pixel8, pixel9, pixel10, pixel11, pixel16, pixel17, pixel18, pixel19, pixel20, pixel21, pixel22, pixel23, pixel24, pixel25, pixel26, pixel27, pixel28, pixel29, pixel30, pixel31, pixel52, pixel53, pixel54, pixel55, pixel56, pixel57, pixel82, pixel83, pixel84, pixel85, pixel111, pixel112, pixel139, pixel140, pixel141, pixel168, pixel196, pixel392, pixel420, pixel421, pixel448, pixel476, pixel532, pixel560, pixel644, pixel645, pixel671, pixel672, pixel673, pixel699, pixel700, pixel701, pixel727, pixel728, pixel729, pixel730, pixel731, pixel754, pixel755, pixel756, pixel757, pixel758, pixel759, pixel760, pixel780, pixel781, pixel782, pixel783.
## 
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |======                                                           |  10%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |===================                                              |  30%
  |                                                                       
  |======================                                           |  35%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |=======================================                          |  59%
  |                                                                       
  |==========================================                       |  64%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |=======================================================          |  84%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================| 100%
## print confusion matrix
h2o.confusionMatrix(model)
## Confusion Matrix - (vertical: actual; across: predicted): vertical: actual; across: predicted
##           0   1    2    3    4   5    6    7    8   9  Error
## 0       987   0    2    2    1   1    3    1    3   0 0.0130
## 1         0 956    7    3    1   0    1    6    3   0 0.0215
## 2         0   2  979    5    3   1    3   31    4   1 0.0486
## 3         1   0   13  974    0   6    0   19    2   3 0.0432
## 4         0   1   11    0  997   1    8    7    0  14 0.0404
## 5         5   0    6   24    2 962   12    6    4   1 0.0587
## 6         5   1   10    0    1   2  986   18    0   0 0.0362
## 7         1   1    8    0    2   1    1  953    0   1 0.0155
## 8         2   5   10    4    2   3    3    6 1011   5 0.0381
## 9         2   2    1    8   15   5    0   39    3 898 0.0771
## Totals 1003 968 1047 1020 1024 982 1017 1086 1030 923 0.0393
##                  Rate
## 0      =   13 / 1,000
## 1      =     21 / 977
## 2      =   50 / 1,029
## 3      =   44 / 1,018
## 4      =   42 / 1,039
## 5      =   60 / 1,022
## 6      =   37 / 1,023
## 7      =     15 / 968
## 8      =   40 / 1,051
## 9      =     75 / 973
## Totals = 397 / 10,100
```



After training the model we can look at the confusion matrix. The total error after 15 epochs is around 0.0395784 which translates to 1 - 0.0395784 = 0.9604216 accuracy score. The training process lasted for -42.966 seconds. Good performance within a short period of time.



## print time elapsed

```{r}

s - proc.time()
##    user  system elapsed 
##   -6.22   -0.22 -359.95

```


Now, let’s predict the test data and save the results.

```{r}

## classify test set
h2o_y_test <- h2o.predict(model, test_h2o)

## convert H2O format into data frame and  save as csv
df_y_test = as.data.frame(h2o_y_test)
df_y_test = data.frame(ImageId = seq(1,length(df_y_test$predict)), Label = df_y_test$predict)
write.csv(df_y_test, file = "submission-r-h2o.csv", row.names=F)

## shut down virutal H2O cluster
h2o.shutdown(prompt = F)
## [1] TRUE
```
